<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #1E92FB; /*è¿›åº¦æ¡é¢œè‰²*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*é˜´å½±é¢œè‰²*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*ä¸Šè¾¹æ¡†é¢œè‰²*/
        border-left-color: #1E92FB;    /*å·¦è¾¹æ¡†é¢œè‰²*/
    }
</style>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
    
  
  <link href="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Neucha:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






  

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="js,React," />





  <link rel="alternate" href="/atom.xml" title="ç§‹æŸ“è’¹è‘­" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0" />






<meta name="description" content="æ­å·ä¸‹é›ªäº†ï¼Œæƒ³å»è¥¿æ¹–çœ‹é›ªäº†ï¼Œé›ªåçš„æ­å·æ›´æœ‰æ°´å¢¨ç”»é‡Œçš„æ„Ÿè§‰äº†ï¼Œä¸€ä¸‹é›ªæ­å·å°±æˆäº†ä¸´å®‰ ä»Šå¤©ä¸»è¦æƒ³è¯´ä¸€ä¸‹react hooksï¼Œreact hooksæ˜¯react v16.8 ä¹‹åå¼•å…¥çš„APIï¼Œç°åœ¨reactéƒ½å·²ç»åˆ°18äº†ï¼Œhooksæ€ä¹ˆè¿˜èƒ½ä¸ä¼šç”¨å‘¢ã€‚hookså¼•å…¥çš„ç›®çš„æ˜¯ç»™å‡½æ•°å¼ç»„ä»¶å¢åŠ æ•°æ®çŠ¶æ€ç®¡ç†çš„èƒ½åŠ›ï¼ŒåŒæ—¶å¢åŠ ä»£ç çš„å¯å¤ç”¨èƒ½åŠ›ã€‚ä½†æ˜¯åŒæ—¶hooksä¹Ÿæ˜¯ä¸€ä¸ªæ½˜å¤šæ‹‰é­”ç›’ï¼Œå› ä¸ºå‡½æ•°å¼ç»„ä»¶ä¸å†åªæ˜¯å•çº¯çš„ä¸€ä¸ª">
<meta name="keywords" content="js,React">
<meta property="og:type" content="article">
<meta property="og:title" content="éƒ½React V18äº†,è¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨React Hookså—,ä¸‡å­—é•¿æ–‡è§£æHooksçš„å¸¸è§é—®é¢˜">
<meta property="og:url" content="https://zhyjor.github.io/2022/12/01/éƒ½React V18äº†ï¼Œè¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨Hookså—/index.html">
<meta property="og:site_name" content="ç§‹æŸ“è’¹è‘­">
<meta property="og:description" content="æ­å·ä¸‹é›ªäº†ï¼Œæƒ³å»è¥¿æ¹–çœ‹é›ªäº†ï¼Œé›ªåçš„æ­å·æ›´æœ‰æ°´å¢¨ç”»é‡Œçš„æ„Ÿè§‰äº†ï¼Œä¸€ä¸‹é›ªæ­å·å°±æˆäº†ä¸´å®‰ ä»Šå¤©ä¸»è¦æƒ³è¯´ä¸€ä¸‹react hooksï¼Œreact hooksæ˜¯react v16.8 ä¹‹åå¼•å…¥çš„APIï¼Œç°åœ¨reactéƒ½å·²ç»åˆ°18äº†ï¼Œhooksæ€ä¹ˆè¿˜èƒ½ä¸ä¼šç”¨å‘¢ã€‚hookså¼•å…¥çš„ç›®çš„æ˜¯ç»™å‡½æ•°å¼ç»„ä»¶å¢åŠ æ•°æ®çŠ¶æ€ç®¡ç†çš„èƒ½åŠ›ï¼ŒåŒæ—¶å¢åŠ ä»£ç çš„å¯å¤ç”¨èƒ½åŠ›ã€‚ä½†æ˜¯åŒæ—¶hooksä¹Ÿæ˜¯ä¸€ä¸ªæ½˜å¤šæ‹‰é­”ç›’ï¼Œå› ä¸ºå‡½æ•°å¼ç»„ä»¶ä¸å†åªæ˜¯å•çº¯çš„ä¸€ä¸ª">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://static.zhyjor.com/wexin.png">
<meta property="og:updated_time" content="2023-10-11T02:22:23.808Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="éƒ½React V18äº†,è¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨React Hookså—,ä¸‡å­—é•¿æ–‡è§£æHooksçš„å¸¸è§é—®é¢˜">
<meta name="twitter:description" content="æ­å·ä¸‹é›ªäº†ï¼Œæƒ³å»è¥¿æ¹–çœ‹é›ªäº†ï¼Œé›ªåçš„æ­å·æ›´æœ‰æ°´å¢¨ç”»é‡Œçš„æ„Ÿè§‰äº†ï¼Œä¸€ä¸‹é›ªæ­å·å°±æˆäº†ä¸´å®‰ ä»Šå¤©ä¸»è¦æƒ³è¯´ä¸€ä¸‹react hooksï¼Œreact hooksæ˜¯react v16.8 ä¹‹åå¼•å…¥çš„APIï¼Œç°åœ¨reactéƒ½å·²ç»åˆ°18äº†ï¼Œhooksæ€ä¹ˆè¿˜èƒ½ä¸ä¼šç”¨å‘¢ã€‚hookså¼•å…¥çš„ç›®çš„æ˜¯ç»™å‡½æ•°å¼ç»„ä»¶å¢åŠ æ•°æ®çŠ¶æ€ç®¡ç†çš„èƒ½åŠ›ï¼ŒåŒæ—¶å¢åŠ ä»£ç çš„å¯å¤ç”¨èƒ½åŠ›ã€‚ä½†æ˜¯åŒæ—¶hooksä¹Ÿæ˜¯ä¸€ä¸ªæ½˜å¤šæ‹‰é­”ç›’ï¼Œå› ä¸ºå‡½æ•°å¼ç»„ä»¶ä¸å†åªæ˜¯å•çº¯çš„ä¸€ä¸ª">
<meta name="twitter:image" content="http://static.zhyjor.com/wexin.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zhyjor.github.io/2022/12/01/éƒ½React V18äº†ï¼Œè¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨Hookså—/"/>





  <title> éƒ½React V18äº†,è¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨React Hookså—,ä¸‡å­—é•¿æ–‡è§£æHooksçš„å¸¸è§é—®é¢˜ | ç§‹æŸ“è’¹è‘­ </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?340874ba9357cbe81570aa4ac1185941";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <a href="https://github.com/zhyjor"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>

	<header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta custom-logo">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">ç§‹æŸ“è’¹è‘­</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <h1 class="site-subtitle" itemprop="description">ä¼šå½“å‡Œç»é¡¶ï¼Œä¸€è§ˆä¼—å±±å°</h1>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://zhyjor.github.io/2022/12/01/éƒ½React V18äº†ï¼Œè¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨Hookså—/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="zhyjor">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ç§‹æŸ“è’¹è‘­">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ç§‹æŸ“è’¹è‘­" src="/images/avatar.jpg">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                éƒ½React V18äº†,è¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨React Hookså—,ä¸‡å­—é•¿æ–‡è§£æHooksçš„å¸¸è§é—®é¢˜
              
            
          </h2>
        

        <div class="post-meta">
		
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-12-01T06:13:21+00:00">
                2022-12-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/React/" itemprop="url" rel="index">
                    <span itemprop="name">React</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2022/12/01/éƒ½React V18äº†ï¼Œè¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨Hookså—/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2022/12/01/éƒ½React V18äº†ï¼Œè¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨Hookså—/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          
 
        


        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>æ­å·ä¸‹é›ªäº†ï¼Œæƒ³å»è¥¿æ¹–çœ‹é›ªäº†ï¼Œé›ªåçš„æ­å·æ›´æœ‰æ°´å¢¨ç”»é‡Œçš„æ„Ÿè§‰äº†ï¼Œä¸€ä¸‹é›ªæ­å·å°±æˆäº†ä¸´å®‰</p>
<p>ä»Šå¤©ä¸»è¦æƒ³è¯´ä¸€ä¸‹react hooksï¼Œreact hooksæ˜¯react v16.8 ä¹‹åå¼•å…¥çš„APIï¼Œç°åœ¨reactéƒ½å·²ç»åˆ°18äº†ï¼Œhooksæ€ä¹ˆè¿˜èƒ½ä¸ä¼šç”¨å‘¢ã€‚hookså¼•å…¥çš„ç›®çš„æ˜¯ç»™å‡½æ•°å¼ç»„ä»¶å¢åŠ æ•°æ®çŠ¶æ€ç®¡ç†çš„èƒ½åŠ›ï¼ŒåŒæ—¶å¢åŠ ä»£ç çš„å¯å¤ç”¨èƒ½åŠ›ã€‚ä½†æ˜¯åŒæ—¶hooksä¹Ÿæ˜¯ä¸€ä¸ªæ½˜å¤šæ‹‰é­”ç›’ï¼Œå› ä¸ºå‡½æ•°å¼ç»„ä»¶ä¸å†åªæ˜¯å•çº¯çš„ä¸€ä¸ªçº¯å‡½æ•°äº†ï¼Œå¯ä»¥åœ¨å†…éƒ¨å¤„ç†å‰¯ä½œç”¨äº†ï¼Œä½¿ç”¨ä¸å¥½å°±ä¼šç»å¸¸é‡åˆ°å„ç§å„æ ·çš„é—®é¢˜ï¼Œè€Œä¸”é”™è¯¯çš„ä½¿ç”¨æ–¹å¼ä¹Ÿä¼šå¼•èµ·re-renderï¼Œå¼•èµ·ä¸€äº›æ€§èƒ½ä¸Šçš„é—®é¢˜</p>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»hooksçš„å¸¸è§çš„å‡ ä¸ªé—®é¢˜ä¸æœ€ä¼˜å®è·µï¼ŒåŒæ—¶ä»‹ç»ä¸€ä¸‹éšç€reactç‰ˆæœ¬è¿­ä»£çš„APIçš„å˜åŒ–</p>
<p>é—²è¨€å°‘å™ï¼Œç›´æ¥è¿›å…¥æ­£æ–‡<br><a id="more"></a><br>é¦–å…ˆï¼Œåœ¨ä½¿ç”¨ä¹‹å‰ï¼Œç¬”è€…è¿˜æ˜¯æƒ³å¼ºè°ƒä¸€ä¸‹</p>
<p><strong>è¯·é…ç½®ä¸Š<code>eslint-plugin-react-hooks</code></strong><br><strong>è¯·é…ç½®ä¸Š<code>eslint-plugin-react-hooks</code></strong><br><strong>è¯·é…ç½®ä¸Š<code>eslint-plugin-react-hooks</code></strong></p>
<p>hooksçš„çš„ä½¿ç”¨ç¡®å®å¾ˆçˆ½ï¼Œä½†æ˜¯å’Œçº¯å‡½æ•°ç›¸æ¯”ï¼Œè¿˜æ˜¯æœ‰æŒºå¤šåç›´è§‰çš„å†™æ³•çš„ï¼Œæ¯”å¦‚ä¸èƒ½åœ¨åˆ¤æ–­è¯­å¥ä¸­ä½¿ç”¨hooksã€‚è¿™å°±å¾ˆå®¹æ˜“æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å·¥å…·æ¥è§„é¿è¿™äº›é—®é¢˜ï¼Œæ¥æé†’æˆ‘ä»¬æœ‰äº›å†™æ³•æ˜¯é”™è¯¯çš„ã€‚å½“ç„¶hooksçš„æœ‰å…¶è‡ªå·±çš„åˆç†æ€§é—®é¢˜ï¼Œæˆ‘ä»¬æš‚æ—¶ä¸åšè®¨è®ºï¼Œè¿™ä¸ªæ’ä»¶æé†’å¯ä»¥ä¿è¯è®©æˆ‘ä»¬çš„å†™æ³•æ˜¯ç¬¦åˆå½“å‰è§„èŒƒçš„ï¼Œä¸è‡³äºå‡ºç°ä½çº§é—®é¢˜</p>
<h2 id="å¼‚æ­¥è°ƒç”¨çš„é—­åŒ…é—®é¢˜"><a href="#å¼‚æ­¥è°ƒç”¨çš„é—­åŒ…é—®é¢˜" class="headerlink" title="å¼‚æ­¥è°ƒç”¨çš„é—­åŒ…é—®é¢˜"></a>å¼‚æ­¥è°ƒç”¨çš„é—­åŒ…é—®é¢˜</h2><p>ç»Ÿè®¡1ç§’å†…æŒ‰é’®ç‚¹å‡»çš„æ¬¡æ•°ï¼Œå…ˆçœ‹ä»£ç ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Demo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> [number, setNumber] = React.useState(<span class="number">0</span>);</div><div class="line">  <span class="keyword">const</span> click = <span class="function"><span class="params">()</span> =&gt;</span></div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      setNumber(number + <span class="number">1</span>);</div><div class="line">    &#125;, <span class="number">1000</span>);</div><div class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;click&#125;</span>&gt;</span> ç‚¹å‡» &#123;number&#125; æ¬¡<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å½“å¤šæ¬¡ç‚¹å‡»çš„æ—¶å€™çš„æ—¶å€™ï¼Œæ˜¾ç¤ºçš„ç‚¹å‡»æ¬¡æ•°é”™è¯¯ã€‚ç‚¹å‡»clickæ–¹æ³•å†…çš„é—­åŒ…å›è°ƒå‡½æ•°åœ¨ç»„ä»¶renderçš„æ—¶å€™æ•è·äº†numberå˜é‡ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨å‡½æ•°æ–¹æ³•æ¥æ›´æ–°æ•°æ®<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> click = <span class="function"><span class="params">()</span> =&gt;</span></div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      setNumber(<span class="function"><span class="params">number</span> =&gt;</span> number + <span class="number">1</span>);</div><div class="line">    &#125;, <span class="number">1000</span>);</div></pre></td></tr></table></figure></p>
<p>åœ¨è°ƒç”¨çŠ¶æ€æ›´æ–°å‡½æ•°çš„æ—¶å€™ï¼Œä¼šå°†å‡†ç¡®çš„æ•°æ®å›è°ƒç»™å½“å‰çš„æ›´æ–°å‡½æ•°</p>
<h3 id="æ›´è¿‘ä¸€æ­¥"><a href="#æ›´è¿‘ä¸€æ­¥" class="headerlink" title="æ›´è¿‘ä¸€æ­¥"></a>æ›´è¿‘ä¸€æ­¥</h3><p>åŒæ ·çš„ï¼Œå‡å¦‚æˆ‘ä»¬ç»Ÿè®¡å¼€å±3ç§’å†…çš„ç‚¹å‡»æ¬¡æ•°ï¼Œåœ¨è®¡æ—¶ç»“æŸåï¼Œå°†ç‚¹å‡»æ¬¡æ•°å‘é€ç»™serverç«¯çš„æ—¶å€™ï¼Œå°±ä¼šé‡åˆ°å¦ä¸€ä¸ªé—®é¢˜<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Demo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> [number, setNumber] = React.useState(<span class="number">0</span>);</div><div class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="comment">// do fetch</span></div><div class="line">      <span class="built_in">console</span>.log(number);</div><div class="line">    &#125;, <span class="number">1000</span>);</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      clearTimeout(timer);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// ä¾èµ–è¿™é‡Œä¼šæœ‰ä¸ªè­¦å‘Š</span></div><div class="line">  &#125;, []);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setNumber((c) =&gt; c + 1)&#125;&gt;ç‚¹å‡»&#123;number&#125;æ¬¡<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>é¦–å…ˆæˆ‘ä»¬ä¼šé‡åˆ°ä¸€ä¸ª<code>eslint-plugin-react-hooks</code>è­¦å‘Š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">React Hook useEffect has a missing dependency: <span class="string">'number'</span>. Either include it or remove the dependency array. (react-hooks/exhaustive-deps)</div></pre></td></tr></table></figure></p>
<p>è€Œä¸”æ‰§è¡Œç»“æœä¹Ÿæ˜¯ç”±äºé—­åŒ…çš„åŸå› ä¸èƒ½æ­£å¸¸æäº¤ï¼Œç†Ÿæ‚‰useEffectåˆ°éƒ½çŸ¥é“ï¼Œè¿™ä¸ªåŸå› æ˜¯ä½¿ç”¨useEffectçš„æ—¶å€™ï¼Œä¾èµ–éœ€è¦æ·»åŠ åˆ°ä¾èµ–æ•°ç»„å†…ï¼Œè¿™æ ·æ‰èƒ½æ›´æ–°æ•°æ®åˆ°useEffectå†…ï¼Œä½†æ˜¯åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ·»åŠ äº†ä¾èµ–åï¼Œæ¯æ¬¡ç‚¹å‡»éƒ½ä¼šå¼•èµ·è®¡æ—¶å™¨é‡æ–°æ‰§è¡Œï¼Œå¼•èµ·å€’è®¡æ—¶å¤±æ•ˆï¼Œå°±å’Œéœ€æ±‚æœ‰å†²çªäº†ï¼Œé‚£è¿™ç§æƒ…å†µä¸‹æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</p>
<p>è¿™ä¸ªé—®é¢˜å…¶å®å¯ä»¥ç®€å•å½’ç´¯ä¸ºï¼š<strong>ä¸æƒ³è®©useEffecté‡æ–°æ‰§è¡Œçš„ä¾èµ–æ€ä¹ˆä½¿ç”¨çš„é—®é¢˜</strong>ï¼Œè¿™ä¸ªåœºæ™¯ä¸‹å°±åªèƒ½ä½¿ç”¨useRefæ¥å®ç°äº†<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Demo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> [number, setNumber] = React.useState(<span class="number">0</span>);</div><div class="line">  <span class="keyword">const</span> numberRef = useRef(number);</div><div class="line">  numberRef.current = number;</div><div class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="comment">// do fetch</span></div><div class="line">      <span class="built_in">console</span>.log(numberRef.current);</div><div class="line">    &#125;, <span class="number">1000</span>);</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      clearTimeout(timer);</div><div class="line">    &#125;;</div><div class="line">  &#125;, []);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;button onClick=&#123;() =&gt; setNumber(<span class="function">(<span class="params">c</span>) =&gt;</span> c + <span class="number">1</span>)&#125;&gt;ç‚¹å‡»&#123;number&#125;æ¬¡&lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">  );</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure></p>
<p>é€šè¿‡useRefå¯ä»¥æ¥ä¿è¯è®¿é—®åˆ°çš„numberä¸€ç›´æ˜¯æœ€æ–°çš„ï¼Œè§£å†³äº†é—­åŒ…çš„é—®é¢˜ï¼ŒåŒæ—¶useEffectæœªç›´æ¥ä¾èµ–numberï¼Œå½“numberå˜åŒ–çš„æ—¶å€™ä¸ä¼šå¼•èµ·é‡æ–°æ‰§è¡Œ</p>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>è™½ç„¶å’Œhooksçš„å†™æ³•æœ‰å…³ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯é—­åŒ…é—®é¢˜ï¼Œæ¯”å¦‚forEachå†…å†™çš„å®šæ—¶å™¨ä¹Ÿä¼šæœ‰åŒæ ·çš„é—®é¢˜ï¼›ä½†æ˜¯å¯¹äºå¼‚æ­¥åœºæ™¯ä¸‹çš„å†™æ³•ï¼Œ<strong>ä¸æƒ³å¼•èµ·useEffecté‡æ–°æ‰§è¡Œçš„å˜é‡ï¼Œå°±å¯ä»¥ç”¨useRefåšä¸€å±‚ä»£ç†</strong>ï¼Œè¿™ç§ç”¨æ³•åªèƒ½è¯´æ˜¯å¯¹react hooksè®¾è®¡çš„<br>ä¸€ç§å¦¥å</p>
<h2 id="ç”¨useCallbackè‚¯å®šèƒ½æå‡æ€§èƒ½å—"><a href="#ç”¨useCallbackè‚¯å®šèƒ½æå‡æ€§èƒ½å—" class="headerlink" title="ç”¨useCallbackè‚¯å®šèƒ½æå‡æ€§èƒ½å—"></a>ç”¨useCallbackè‚¯å®šèƒ½æå‡æ€§èƒ½å—</h2><p>useCallbackçš„ä½œç”¨æ˜¯ç¼“å­˜å‡½æ•°ï¼Œé¿å…é‡å¤ç”Ÿæˆæ–°å‡½æ•°ï¼Œå¼•èµ·ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œæ¯”å¦‚ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Children = <span class="function">(<span class="params">props</span>) =&gt;</span> &lt;button onClick=&#123;props.doFetch&#125;&gt;æäº¤&lt;<span class="regexp">/button&gt;;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default function Demo() &#123;</span></div><div class="line"><span class="regexp">  const doFetch = useCallback(() =&gt; &#123;</span></div><div class="line"><span class="regexp">    /</span><span class="regexp">/ fetch();</span></div><div class="line"><span class="regexp">  &#125;, []);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">  return &lt;Children doFetch=&#123;doFetch&#125; /</span>&gt;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„å†™æ³•ï¼Œä½†æ˜¯éœ€è¦æ˜ç¡®åœ¨classç»„ä»¶çš„æ—¶å€™æˆ‘ä»¬é€šå¸¸ä½¿ç”¨<code>shouldComponentUpdate</code>æ¥æ‹¦æˆªæ›´æ–°ï¼Œé€šè¿‡æ¯”è¾ƒçˆ¶ç»„ä»¶ä¼ å…¥çš„propsçš„å˜åŒ–ï¼Œæ¥è§‰å¾—æ˜¯å¦re-renderå­ç»„ä»¶ï¼Œä¸Šé¢çš„ğŸŒ°ä¸­ï¼Œ<code>&lt;Children /&gt;</code>åªæ˜¯ä¸€ä¸ªæ™®é€šç»„ä»¶ï¼Œåªå¯¹ä¼ å…¥çš„å‡½æ•°åŒ…è£¹ä¸€å±‚useCallbackæ˜¯ä¸èƒ½èµ·åˆ°ä¼˜åŒ–ä½œç”¨çš„ï¼Œéœ€è¦é€šè¿‡åŒ…è£¹ä¸€å±‚<code>React.memo</code>æ‰å¯ä»¥ï¼ŒReact.memoä¼šå¯¹å¯¹ä¼ å…¥çš„propsè¿›è¡Œä¸€æ¬¡æµ…æ¯”è¾ƒï¼Œé¿å…éå¿…è¦çš„æ›´æ–°ï¼Œå¦‚ä¸‹<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Children = React.memo(<span class="function">(<span class="params">props</span>) =&gt;</span> &lt;button onClick=&#123;props.doFetch&#125;&gt;æäº¤&lt;<span class="regexp">/button&gt;);</span></div></pre></td></tr></table></figure></p>
<p>å¦å¤–éœ€è¦è¡¥å……çš„æ˜¯ï¼Œå‡å¦‚æœ‰ä¸€äº›ç‰¹åˆ«å¤æ‚çš„å¯¹è±¡å±æ€§éœ€è¦ä¼ å…¥çš„è¯ï¼Œå¯ä»¥è€ƒè™‘é€šè¿‡useMemoè¿›è¡Œä¸€å±‚åŒ…è£¹ï¼Œé¿å…ä¸€äº›ä¸å¿…è¦çš„re-renderã€‚å½“ç„¶ï¼Œä½¿ç”¨useMemoä¹Ÿæ˜¯æœ‰ä¸€å®šçš„æ€§èƒ½æˆæœ¬çš„ï¼Œå‡å¦‚åªæ˜¯ç®€å•è®¡ç®—çš„è¯ï¼Œç›´æ¥è®¡ç®—å°±å¯ä»¥äº†ï¼Œå¯èƒ½è¿™æ ·çš„æˆæœ¬è¿˜å°ä¸€äº›ã€‚</p>
<h3 id="æ€è€ƒé¢˜"><a href="#æ€è€ƒé¢˜" class="headerlink" title="æ€è€ƒé¢˜"></a>æ€è€ƒé¢˜</h3><p>ä¸‹é¢è¿™ä¸ªåœºæ™¯ä¸‹useCallbackå’ŒReact.memoç»„åˆå¯ä»¥èµ·åˆ°ä¼˜åŒ–çš„ä½œç”¨å—ï¼Ÿ<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Children = React.memo(<span class="function">(<span class="params">props</span>) =&gt;</span> &lt;button onClick=&#123;props.doSubmit&#125;&gt;æäº¤&lt;<span class="regexp">/button&gt;);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default function Demo() &#123;</span></div><div class="line"><span class="regexp">  const [number, setNumber] = useState(0);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">  const doSubmit = useCallback(() =&gt; &#123;</span></div><div class="line"><span class="regexp">    console.log(`Number: $&#123;number&#125;`); /</span><span class="regexp">/ æ¯æ¬¡è¾“å‡ºéƒ½æ˜¯åˆå§‹å€¼</span></div><div class="line"><span class="regexp">  &#125;, [number]); /</span><span class="regexp">/ æŠŠ`text`å†™åœ¨ä¾èµ–æ•°ç»„é‡Œ</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">  return (</span></div><div class="line"><span class="regexp">    &lt;&gt;</span></div><div class="line"><span class="regexp">      &lt;input value=&#123;number&#125; onChange=&#123;(e) =&gt; setNumber(e.target.value)&#125; /</span>&gt;</div><div class="line">      &lt;Children doSubmit=&#123;doSubmit&#125; /&gt;</div><div class="line">    &lt;<span class="regexp">/&gt;</span></div><div class="line"><span class="regexp">  );</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure></p>
<p>ç»“è®ºæ˜¯ä¸è¡Œï¼ŒåŸå› å¯ä»¥è€ƒè™‘ä¸€ä¸‹useCallbackçš„depsè¯¥æ€ä¹ˆå¤„ç†</p>
<h3 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>åªéœ€è¦è®°å¾—<strong>ä½¿ç”¨useCallbackçš„æ—¶å€™ï¼Œå¯¹åº”çš„å­ç»„ä»¶ä¸€å®šè¦ä½¿ç”¨React.memoåŒ…è£¹</strong>ï¼Œå¦åˆ™ä½¿ç”¨useCallbackå°±æ²¡æœ‰ä»»ä½•çš„æ„ä¹‰ã€‚å½“ç„¶useCallbackçš„depsè¦æ ¹æ®å®é™…åœºæ™¯æ¥æ·»åŠ ï¼Œå¦åˆ™å°±ä¸ä¼šæœ‰ä»»ä½•çš„ä¼˜åŒ–æ•ˆæœã€‚</p>
<p>å¦å¤–å¯¹äºuseCallbackï¼Œç¬”è€…ä¸ªäººçš„ç†è§£æ˜¯æœ‰äº›ç ´åä»£ç çš„å¯è¯»æ€§äº†ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦æŒ‰ç…§åœºæ™¯å…·ä½“è¯„ä¼°ä¸€ä¸‹ï¼Œæ˜¯å¦çœŸçš„éœ€è¦æ— è„‘ä½¿ç”¨ï¼Œå¹³è¡¡å¥½ä»£ç å¯ç»´æŠ¤æ€§å’Œæ€§èƒ½</p>
<h2 id="hooksç»„ä»¶æ€ä¹ˆä¼˜é›…çš„ä½¿ç”¨refs"><a href="#hooksç»„ä»¶æ€ä¹ˆä¼˜é›…çš„ä½¿ç”¨refs" class="headerlink" title="hooksç»„ä»¶æ€ä¹ˆä¼˜é›…çš„ä½¿ç”¨refs"></a>hooksç»„ä»¶æ€ä¹ˆä¼˜é›…çš„ä½¿ç”¨refs</h2><p>å…¶å®è¿™ä¸ªé—®é¢˜æœ‰äº›ä¼ªå‘½é¢˜çš„æ„Ÿè§‰ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨åœ¨çˆ¶ç»„ä»¶ä¸­é€šè¿‡refæ“ä½œå­ç»„ä»¶çš„æ–¹æ³•æ—¶ï¼Œå·²ç»å°±æ˜¯ä¸ä¼˜é›…çš„äº†ã€‚å®˜æ–¹æ–‡æ¡£è¿™æ ·è¯´ï¼š</p>
<blockquote>
<p>åœ¨å¸¸è§„çš„ React æ•°æ®æµä¸­ï¼Œprops æ˜¯çˆ¶ç»„ä»¶ä¸å­ç»„ä»¶äº¤äº’çš„å”¯ä¸€æ–¹å¼ã€‚è¦ä¿®æ”¹å­å…ƒç´ ï¼Œä½ éœ€è¦ç”¨æ–°çš„ props å»é‡æ–°æ¸²æŸ“å­å…ƒç´ </p>
</blockquote>
<p>åªèƒ½è¯´éå¿…è¦çš„å°½é‡é¿å…ç›´æ¥ä½¿ç”¨refå§ï¼Œå°½é‡é¿å…æ‰“ä¹±reactçš„å•å‘æ•°æ®æµã€‚é‚£å›åˆ°æˆ‘ä»¬çš„é—®é¢˜ï¼Œä½¿ç”¨hooksçš„æ—¶å€™å¦‚ä½•ä½¿ç”¨æ›´ä¼˜é›…çš„ä½¿ç”¨refå‘¢</p>
<p>å®˜æ–¹æ–‡æ¡£æä¾›äº†ä»¥ä¸‹å‡ ä¸ªåœºæ™¯åˆšå¥½é€‚åˆä½¿ç”¨Refs</p>
<ul>
<li>å¤„ç†focusã€æ–‡æœ¬é€‰æ‹©æˆ–è€…åª’ä½“æ’­æ”¾</li>
<li>è§¦å‘å¼ºåˆ¶åŠ¨ç”»</li>
<li>åŸºå±‚ç¬¬ä¸‰æ–¹åº“</li>
</ul>
<h3 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h3><p>ç”±äºå‡½æ•°ç»„ä»¶æ²¡æœ‰å®ä¾‹ï¼Œåœ¨å‡½æ•°ç»„ä»¶å†…ä¸èƒ½ä½¿ç”¨string ref,callback ref, create refï¼Œä¼šæœ‰å¦‚ä¸‹æŠ¥é”™</p>
<blockquote>
<p>Uncaught Invariant Violation: Function components cannot have refs. Did you mean to use React.forwardRef()?</p>
</blockquote>
<p>æ‰€ä»¥åœ¨å‡½æ•°ç»„ä»¶å†…æ˜¯èƒ½ä½¿ç”¨useRef,ç”±äºuseRefè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åªæœ‰currentä¸€ä¸ªå€¼ï¼Œå¹¶ä¸”è¿™ä¸ªå€¼çš„åœ°å€åœ¨æ•´ä¸ªç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå†…ä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥useRefæä¾›äº†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå†…å…±äº«æ•°æ®çš„å­˜å‚¨ï¼Œä¿®æ”¹äº†ref.currentçš„å€¼ä¸ä¼šè§¦å‘ç»„ä»¶re-renderï¼Œè€Œä¸”ç»„ä»¶re-renderçš„æ—¶å€™ï¼Œref.currentçš„å€¼ä¹Ÿä¼šä¿ç•™ï¼Œç±»ä¼¼classç»„ä»¶çš„é™æ€å˜é‡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨useRefåšå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚æŒ‚è½½ç‰¹å®šçš„domæˆ–è€…å­ç»„ä»¶çš„å®ä¾‹ã€å­˜å‚¨å…¨å±€å®šæ—¶å™¨ç­‰ç­‰</p>
<p>é‚£useRefæ€ä¹ˆä½¿ç”¨å‘¢ï¼Œé’ˆå¯¹å®˜æ–¹é—®é¢˜æä¾›çš„å‡ ä¸ªåœºæ™¯ï¼Œç¬”è€…ç®€å•ç»™å‡ºå‡ ä¸ªdemo</p>
<h4 id="è·å–ç‰¹å®šdom"><a href="#è·å–ç‰¹å®šdom" class="headerlink" title="è·å–ç‰¹å®šdom"></a>è·å–ç‰¹å®šdom</h4><p>å¯¹äºåŸç”Ÿå…ƒç´ å¯ä»¥ç›´æ¥ä½¿ç”¨<br><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Input</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> inputRef = useRef(<span class="literal">null</span>);</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">click</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    inputRef.current.focus();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;div&gt;</div><div class="line">      &lt;input type=<span class="string">"text"</span> ref=&#123;inputRef&#125; /&gt;</div><div class="line">      &lt;input type=<span class="string">"button"</span> value=<span class="string">"Focus the text input"</span> onClick=&#123;click&#125; /&gt;</div><div class="line">    &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">  );</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure></p>
<p>é€šè¿‡ref.currentå¯ä»¥ç›´æ¥æ“ä½œinput</p>
<h3 id="useRef-forwardRef-useImperativeHandleç»„åˆç”¨æ³•"><a href="#useRef-forwardRef-useImperativeHandleç»„åˆç”¨æ³•" class="headerlink" title="useRef,forwardRef,useImperativeHandleç»„åˆç”¨æ³•"></a>useRef,forwardRef,useImperativeHandleç»„åˆç”¨æ³•</h3><p>é¦–å…ˆå…ˆè¯´ä¸€ä¸‹forwardRef</p>
<blockquote>
<p>Ref è½¬å‘æ˜¯ä¸€é¡¹å°† ref è‡ªåŠ¨åœ°é€šè¿‡ç»„ä»¶ä¼ é€’åˆ°å…¶ä¸€å­ç»„ä»¶çš„æŠ€å·§ã€‚å¯¹äºå¤§å¤šæ•°åº”ç”¨ä¸­çš„ç»„ä»¶æ¥è¯´ï¼Œè¿™é€šå¸¸ä¸æ˜¯å¿…éœ€çš„ã€‚ä½†å…¶å¯¹æŸäº›ç»„ä»¶ï¼Œå°¤å…¶æ˜¯å¯é‡ç”¨çš„ç»„ä»¶åº“æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚</p>
</blockquote>
<p>ç®€ç­”æ¥è¯´ï¼Œå°±æ˜¯å‡½æ•°å¼ç»„ä»¶è¦æƒ³æš´éœ²ç»™çˆ¶ç»„ä»¶refçš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨forwardRefæ‰èƒ½è¿›è¡Œrefçš„ä¼ é€’ã€‚éœ€è¦æ˜ç¡®çš„æ˜¯<strong>ä¸èƒ½åœ¨å‡½æ•°å¼ç»„ä»¶ä¸Šä½¿ç”¨refå±æ€§ï¼Œå› ä¸ºå‡½æ•°å¼ç»„ä»¶æ²¡æœ‰å®ä¾‹</strong>ï¼Œä½¿ç”¨çš„è¯ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>ç„¶åå†è¯´ä¸€ä¸‹useImperativeHandleï¼Œå‡½æ•°å¼ç»„ä»¶ä½¿ç”¨useImperativeHandle å¯ä»¥é€šè¿‡ forwardRef æš´éœ²ç»™çˆ¶ç»„ä»¶çš„è‡ªå®šä¹‰æ–¹æ³•ã€‚è¿™å¯ä»¥ç±»æ¯”äºclassç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡classç»„ä»¶è·å–refçš„ç»„ä»¶å®ä¾‹ï¼Œè¿›è€Œè°ƒç”¨å†…éƒ¨æ–¹æ³•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡useImperativeHandleæš´éœ²çš„æ–¹æ³•ï¼Œè°ƒç”¨å‡½æ•°å¼ç»„ä»¶çš„å†…éƒ¨æ–¹æ³•ï¼Œç›´æ¥çœ‹ğŸŒ°<br><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123; useRef, useImperativeHandle &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</div><div class="line"><span class="keyword">const</span> Children = React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> inputRef = useRef(<span class="literal">null</span>);</div><div class="line">  useImperativeHandle(</div><div class="line">    ref,</div><div class="line">    () =&gt; &#123;</div><div class="line">      <span class="keyword">const</span> handleRefs = &#123;</div><div class="line">        onFocus() &#123;</div><div class="line">          inputRef.current.focus();</div><div class="line">        &#125;</div><div class="line">      &#125;;</div><div class="line">      <span class="keyword">return</span> handleRefs;</div><div class="line">    &#125;,</div><div class="line">    []</div><div class="line">  );</div><div class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"è¯·è¾“å…¥"</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> /&gt;</span>;</span></div><div class="line"><span class="xml">&#125;);</span></div><div class="line"><span class="xml"></span></div><div class="line"><span class="xml">const Demo = () =&gt; &#123;</span></div><div class="line"><span class="xml">  const childRef = useRef(null);</span></div><div class="line"><span class="xml">  const click = () =&gt; &#123;</span></div><div class="line"><span class="xml">    const &#123; onFocus &#125; = childRef.current;</span></div><div class="line"><span class="xml">    onFocus();</span></div><div class="line"><span class="xml">  &#125;;</span></div><div class="line"><span class="xml">  return (</span></div><div class="line"><span class="xml">    <span class="tag">&lt;&gt;</span></span></div><div class="line">      &lt;Children ref=&#123;childRef&#125; /&gt;</div><div class="line">      &lt;button onClick=&#123;click&#125;&gt;è¾“å…¥æ¡†focused&lt;/button&gt;</div><div class="line">    &lt;/&gt;</div><div class="line">  );</div><div class="line">&#125;;</div><div class="line"></div><div class="line">export default Demo;</div></pre></td></tr></table></figure></p>
<p>useImperativeHandle æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>forWardRefè½¬å‘è¿‡æ¥çš„ref</li>
<li>è‡ªå®šä¹‰å¤„ç†å‡½æ•°ï¼Œè¿”å›å€¼æ—¶æš´éœ²ç»™çˆ¶ç»„ä»¶çš„refå¯¹è±¡</li>
<li>ä¾èµ–é¡¹depsï¼Œæ ¹æ®å®é™…çš„ä¾èµ–ä¼ å…¥å³å¯ï¼Œç”¨äºæ›´æ–°refå¯¹è±¡</li>
</ul>
<p>é€šè¿‡useImperativeHandleå¤–éƒ¨ç»„ä»¶å°±å¯ä»¥ç›¸å¯¹ä¼˜é›…çš„è·å–åˆ°å­ç»„ä»¶çš„â€œå®ä¾‹â€ï¼Œè°ƒç”¨å­ç»„ä»¶çš„å†…éƒ¨æ–¹æ³•</p>
<h3 id="å°ç»“-2"><a href="#å°ç»“-2" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>å†™åˆ°è¿™é‡Œï¼Œå…¶å®æˆ‘ä»¬ä¹Ÿèƒ½å‘ç°ï¼ŒuseRefçš„ä½¿ç”¨é¢‘ç‡è¿˜æ˜¯æŒºé«˜çš„ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥æŠŠuseRefå½“æˆæ™®é€šçš„refçš„ç›¸å…³APIï¼Œç”¨æ¥æ“ä½œå­ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥å°†å…¶ä½œä¸ºä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶å†…çš„é™æ€å˜é‡æ¥ä½¿ç”¨ï¼Œå¯ä»¥è¯´æ˜¯hooksé‡åˆ°é—®é¢˜çš„æ—¶å€™éå¸¸ä¸‡é‡‘æ²¹çš„å­˜åœ¨äº†</p>
<p>è¯´å›ref,åŸºæœ¬å¯¹äºå‡½æ•°å¼ç»„ä»¶æ¥è¯´ï¼ŒuseRef,forwardRef,useImperativeHandleç»„åˆç”¨æ³•èƒ½è¦†ç›–æ‰€æœ‰éœ€æ±‚äº†ï¼Œä½†æ˜¯è¿˜æ˜¯é‚£å¥è¯ï¼Œèƒ½å°½é‡é¿å…ä½¿ç”¨çš„å°±é¿å…ä½¿ç”¨ï¼Œè®©è‡ªå·±çš„ä»£ç æœ‰æ›´é«˜çš„å¯ç»´æŠ¤æ€§</p>
<h2 id="å¦‚ä½•å°è£…è‡ªå®šä¹‰hooks"><a href="#å¦‚ä½•å°è£…è‡ªå®šä¹‰hooks" class="headerlink" title="å¦‚ä½•å°è£…è‡ªå®šä¹‰hooks"></a>å¦‚ä½•å°è£…è‡ªå®šä¹‰hooks</h2><p>è‡ªå®šä¹‰hooksæ˜¯åŸºäºreact hooks apiçš„è‡ªå®šä¹‰æ‰©å±•ï¼Œå¯ä»¥å°†ä¸€æ®µé€šç”¨æ€§é€»è¾‘å°è£…èµ·æ¥ï¼Œè¾¾åˆ°å¤ç”¨çš„æ•ˆæœ; ç®€å•æ¥è¯´é€šè¿‡è‡ªå®šä¹‰ Hookï¼Œå¯ä»¥å°†ç»„ä»¶é€»è¾‘æå–åˆ°å¯é‡ç”¨çš„å‡½æ•°ä¸­ï¼Œå¯ä»¥åœ¨ç»„ä»¶å†…ç›´æ¥ä½¿ç”¨</p>
<p>å°è£…çš„è‡ªå®šä¹‰hooksä¸€èˆ¬å†…éƒ¨ä½¿ç”¨å¤šä¸ªreact hooksï¼Œç”¨äºè§£å†³ä¸€äº›å¤æ‚ä¸”é€šç”¨çš„é€»è¾‘ã€‚æ¥ä¸‹æ¥çœ‹å‡ ä¸ªğŸŒ°ï¼Œç„¶åå¯ä»¥å¯¹æ¯”ä¸€ä¸‹è‡ªå·±çš„åœºæ™¯ï¼Œå½“ç„¶ä¹Ÿå¹¶ä¸æ˜¯æ‰€æœ‰èƒ½ç”¨è‡ªå®šä¹‰hooksçš„åœ°æ–¹ï¼Œå°±å¿…é¡»è¦ç”¨è‡ªå®šä¹‰hooksçš„ï¼Œè¿˜æ˜¯è¦åˆ¤æ–­ä¸€ä¸‹å¯å¤ç”¨ç¨‹åº¦å†åšå†³å®š</p>
<h3 id="æå–è‡ªå®šä¹‰-hooks"><a href="#æå–è‡ªå®šä¹‰-hooks" class="headerlink" title="æå–è‡ªå®šä¹‰ hooks"></a>æå–è‡ªå®šä¹‰ hooks</h3><blockquote>
<p>å½“æˆ‘ä»¬æƒ³åœ¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´å…±äº«é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬ä¼šæŠŠå®ƒæå–åˆ°ç¬¬ä¸‰ä¸ªå‡½æ•°ä¸­ã€‚è€Œç»„ä»¶å’Œ Hook éƒ½æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥ä¹ŸåŒæ ·é€‚ç”¨è¿™ç§æ–¹å¼ã€‚</p>
</blockquote>
<p>è‡ªå®šä¹‰ hooks æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…¶åç§°ä»¥ â€œuseâ€ å¼€å¤´ï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥è°ƒç”¨å…¶ä»–çš„ Hookã€‚è‡ªå®šä¹‰hookså’Œæ™®é€šçš„å‡½æ•°å¹¶æ²¡æœ‰ä»»ä½•ä¸åŒï¼Œä½†æ˜¯ç»“åˆå…¬å…±hooks APIçš„èƒ½åŠ›ï¼Œåœ¨reactçš„è°ƒåº¦ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å¾ˆå¤šå¾ˆæœ‰è¶£çš„åŠŸèƒ½ï¼Œç¤¾åŒºæœ‰å®ç°çš„<a href="https://github.com/alibaba/hooks?spm=ata.21736010.0.0.1b261134fcWTYx" target="_blank" rel="external">ahooks</a>è‡ªå®šä¹‰hooksåº“ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å‚è€ƒä¸€ä¸‹</p>
<p>æ¥ä¸‹æ¥ç®€å•æ”¾å‡ ä¸ªç›¸å¯¹æœ‰ä»£è¡¨æ€§çš„ğŸŒ°ï¼š</p>
<h3 id="useStateå±æ€§åˆå¹¶"><a href="#useStateå±æ€§åˆå¹¶" class="headerlink" title="useStateå±æ€§åˆå¹¶"></a>useStateå±æ€§åˆå¹¶</h3><p>ä½ çš„ä»£ç é‡Œæ˜¯ä¸æ˜¯å†™è¿‡è¿™æ ·çš„ä»£ç <br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> [duration, setDuration] = useState(<span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> [currentTime, setCurrentTime] = useState(<span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> [volume, setCurrent] = useState(<span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> [speed, setSpeed] = useState(<span class="number">0</span>);</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>è¿™æ®µä»£ç æ˜¯ä¹‹å‰å°è£…æ’­æ”¾å™¨çš„ä¸€æ®µä»£ç ï¼Œé‡Œé¢å¯¹videoçš„å±æ€§è¿›è¡Œä¸€å®šçš„æå–ï¼Œå¯¼è‡´äº†ä»£ç ä¸­ä¸€æ’è”šä¸ºå£®è§‚çš„useState,è¿™æ ·çš„å†™æ³•å…¶å®å¯ä»¥ä¼˜åŒ–åˆ°ä¸€ä¸ªå­—æ®µå†…<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> [player, setPlayer] = useState(&#123;</div><div class="line">  duration: <span class="number">0</span>,</div><div class="line">  currentTime: <span class="number">0</span>,</div><div class="line">  volume: <span class="number">0</span>,</div><div class="line">  speed: <span class="number">0</span>,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>å½“ç„¶è¿™ä¸ªæ—¶å€™æ›´æ–°è£…çŠ¶æ€éœ€è¦å¸¦ä¸Šæ—§çš„çŠ¶æ€<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">setPlayer(&#123;...player, duration&#125;);</div></pre></td></tr></table></figure></p>
<p>é‚£æ€ä¹ˆæ‰èƒ½å†çœç‚¹ä»£ç ï¼Œè®©æˆ‘å¯ä»¥ç›´æ¥ä¿®æ”¹éœ€è¦ä¿®æ”¹çš„å‚æ•°ï¼Œä¸éœ€è¦æ”¹å˜çš„ä¾æ—§ä¿æŒç°çŠ¶å‘¢ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥å°è£…ä¸€ä¸ªè‡ªå®šä¹‰hooksï¼Œå¦‚ä¸‹<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> useMergeState = <span class="function">(<span class="params">initialState</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> [state, setState] = useState(initialState);</div><div class="line">  <span class="keyword">const</span> setMergeState = <span class="function">(<span class="params">pickState</span>) =&gt;</span> &#123;</div><div class="line">    setState(<span class="function"><span class="params">preState</span> =&gt;</span> &#123;...preState, &#123;...pickState&#125;&#125;);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> [state, setMergeState]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™æ ·å°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> [player, setPlayer] = useMergeState(&#123;</div><div class="line">  duration: <span class="number">0</span>,</div><div class="line">  currentTime: <span class="number">0</span>,</div><div class="line">  volume: <span class="number">0</span>,</div><div class="line">  speed: <span class="number">0</span>,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">setPlayer(&#123; <span class="attr">duration</span>: <span class="number">2</span>&#125;);</div></pre></td></tr></table></figure></p>
<p>è¿™å°±æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„è‡ªå®šä¹‰hooksï¼Œå½“ç„¶useMergeStateè¿˜æœ‰å¯ä¼˜åŒ–çš„åœ°æ–¹ï¼Œæ¯”å¦‚å‚è€ƒuseStateçš„ç”¨æ³•ï¼ŒpickStateå¯èƒ½æ˜¯ä¸ªå‡½æ•°ï¼Œéœ€è¦åˆ¤æ–­ä¸€ä¸‹å…¥å‚ç±»å‹ï¼›ç„¶åå†…éƒ¨çš„å®ç°setMergeStateå…¶å®å¯ä»¥é€šè¿‡useCallbackè¿›è¡Œä¸€ä¸‹åŒ…è£¹ï¼Œè®©å‡½æ•°ä¸ç”¨æ¯æ¬¡éƒ½åˆå§‹åŒ–ç­‰ç­‰</p>
<h3 id="domç›¸å…³çš„hooks"><a href="#domç›¸å…³çš„hooks" class="headerlink" title="domç›¸å…³çš„hooks"></a>domç›¸å…³çš„hooks</h3><p>æˆ‘ä»¬ç»å¸¸ä¼šç›‘å¬domçš„æ»šåŠ¨æ¥åšä¸€äº›è‡ªå®šä¹‰çš„é€»è¾‘ï¼Œæ¯”å¦‚æ»šåŠ¨ç¿»é¡µç­‰ç­‰ï¼Œä¸€ä¸ªç›‘å¬æ»šåŠ¨çš„è‡ªå®šä¹‰hooksè¯¥æ€ä¹ˆå®ç°å‘¢ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç¡®å®šæˆ‘ä»¬éœ€è·å–åˆ°å“ªäº›å€¼ï¼Œä»¥åŠæˆ‘ä»¬çš„å…¥å‚æ•°æ˜¯ä»€ä¹ˆ</p>
<h4 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h4><p>å…¥å‚ï¼šæ¯‹åº¸ç½®ç–‘è‚¯å®šæ˜¯domå…ƒç´ çš„å¼•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨useRefæ¥å®ç°<br>è¿”å›å€¼ï¼šä¸€èˆ¬éƒ½æ˜¯å…ƒç´ æ»šåŠ¨çš„é«˜åº¦ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æ¥å†³å®š</p>
<h4 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> useScroll = <span class="function">(<span class="params">target</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> [position, setPosition] = useState();</div><div class="line"></div><div class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">onscroll</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">      setPos([target.current.scrollLeft, target.current.scrollTop])</div><div class="line">    &#125;</div><div class="line">    target.current.addEventListener(<span class="string">'scroll'</span>, onscroll, <span class="literal">false</span>)</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      target.current.removeEventListener(<span class="string">'scroll'</span>, onscroll, <span class="literal">false</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;, [])</div><div class="line"></div><div class="line">  <span class="keyword">return</span> position</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> useScroll</div></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä»£ç ä¹Ÿæ˜¯æœ‰ä¸€äº›å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œæ¯”å¦‚ä¸€äº›å‚æ•°æœ‰æ•ˆæ€§çš„åˆ¤æ–­ç­‰ï¼Œè¿™ä¸ªğŸŒ°åªæ˜¯ä¸€ä¸ªæ¼”ç¤ºï¼Œæä¾›ä¸€ä¸ªå‚è€ƒæ€è·¯</p>
<h3 id="é˜²æŠ–å‡½æ•°"><a href="#é˜²æŠ–å‡½æ•°" class="headerlink" title="é˜²æŠ–å‡½æ•°"></a>é˜²æŠ–å‡½æ•°</h3><p>é˜²æŠ–èŠ‚æµå‡½æ•°å¤§å®¶è‚¯å®šç»å¸¸åœ¨å¼€å‘ä¸­é‡åˆ°ï¼Œé¢è¯•çš„ä¼°è®¡ä¹Ÿæ²¡æœ‰è¢«å°‘é—®ã€‚ä¸€èˆ¬éƒ½æ˜¯æˆ‘ä»¬é¿å…é¢‘ç¹è°ƒç”¨æ¥å£ï¼Œæˆ–è€…åœ¨reactä¸­é¿å…é¢‘ç¹æ”¹åŠ¨stateçš„æ—¶å€™éœ€è¦ä½¿ç”¨çš„ï¼Œé˜²æŠ–èŠ‚æµçš„åŒºåˆ«è¿™é‡Œä¹Ÿä¸èµ˜è¿°äº†ï¼Œç®€å•æ¥è¯´ä¸»è¦åŒºåˆ«å°±æ˜¯é˜²æŠ–æ˜¯æ“ä½œånç§’å†…åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œå‡å¦‚nç§’å†…åˆè§¦å‘äº†æ“ä½œï¼Œé‡æ–°å€’è®¡æ—¶nç§’ï¼›èŠ‚æµå°±æ˜¯æ“ä½œnç§’å†…åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œå³ä½¿æ˜¯å¤šæ¬¡è§¦å‘æ“ä½œä¹Ÿæ˜¯nç§’å†…æ‰§è¡Œä¸€æ¬¡ï¼›èŠ‚æµä¸€èˆ¬ç”¨åœ¨è¾“å…¥æ¡†æœç´¢ï¼Œéœ€è¦åœ¨æœ€åä¸€æ¬¡æäº¤åè§¦å‘ï¼›èŠ‚æµä¸€èˆ¬ç”¨åœ¨æ»šåŠ¨ç›‘å¬ç­‰ç­‰ã€‚</p>
<h4 id="ä»£ç å®ç°-1"><a href="#ä»£ç å®ç°-1" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; useEffect, useMemo &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> debounce <span class="keyword">from</span> <span class="string">'lodash/debounce'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> useDebounce = <span class="function">(<span class="params">fn, wait</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> wait = wait ?? <span class="number">1000</span>;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> debounced = useMemo(</div><div class="line">      () =&gt;</div><div class="line">        debounce(</div><div class="line">          fn(),</div><div class="line">          wait</div><div class="line">        ),</div><div class="line">      [],</div><div class="line">  );</div><div class="line">  <span class="keyword">return</span> [debounced.run, debounced.cancel];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä»£ç ä¸ºäº†çªå‡ºè‡ªå®šä¹‰hooksçš„ç”¨æ³•ï¼ŒåŸºäºlodash/debounceå®ç°äº†ä¸€ä¸ªèŠ‚æµhooksï¼Œå…¶å®æ ¸å¿ƒå°±æ˜¯ç®€åŒ–debounceçš„ç”¨æ³•ï¼Œå½“ç„¶lodash/debounceè¿˜æœ‰æ›´å¤šçš„é…ç½®ï¼Œè‡ªå·±å¯ä»¥åŸºäºè‡ªå·±çš„å®é™…åœºæ™¯è¿›è¡Œå°è£…</p>
<p>è‡³äºèŠ‚æµå‡½æ•°å°±ä½œä¸ºä¸€ä¸ªæ€è€ƒé¢˜å¯ä»¥è‡ªå·±å®ç°ä¸€ä¸‹</p>
<h3 id="å°ç»“-3"><a href="#å°ç»“-3" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>è‡ªå®šä¹‰hookså¯ä»¥ç»´æŠ¤åœ¨é¡¹ç›®ä¸­çš„ä¸€ä¸ªå•ç‹¬hooksæ–‡ä»¶å¤¹å†…ï¼Œä½œä¸ºå…¨å±€å…¬å…±æ–¹æ³•æä¾›ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å‘å¸ƒåˆ°è‡ªå·±çš„npmç»„ä»¶ï¼Œæä¾›ç»™æ›´å¤šçš„é¡¹ç›®ä½¿ç”¨ã€‚è¿˜æœ‰è·Ÿå¤šçš„ç”¨æ³•å°±ä¸å†ä¸€ä¸€æ¼”ç¤ºäº†ï¼Œå¯ä»¥è‡ªå·±å®ç°ä¸€äº›ï¼Œå·²åŠ æ·±å¯¹è‡ªå®šä¹‰hooksçš„ç†è§£</p>
<h2 id="React-V18æ–°å¢äº†å“ªäº›hooks-API"><a href="#React-V18æ–°å¢äº†å“ªäº›hooks-API" class="headerlink" title="React V18æ–°å¢äº†å“ªäº›hooks API"></a>React V18æ–°å¢äº†å“ªäº›hooks API</h2><p>React V18å·²ç»å‘å¸ƒäº†ä¸€æ®µæ—¶é—´äº†ï¼Œé’ˆå¯¹hooksä¹Ÿæä¾›äº†ä¸€äº›æ–°çš„APIã€‚æ–°å¢çš„APIæœ‰<code>useIdï¼ŒuseInsertionEffectï¼ŒuseTransitionï¼ŒuseDeferredValueï¼ŒuseSyncExternalStore</code>ï¼Œè®©æˆ‘ä»¬ä¸€ä¸€çœ‹çœ‹æä¾›äº†ä»€ä¹ˆæ–°çš„èƒ½åŠ›ã€‚</p>
<h3 id="Beforeï¼Œå…ˆçœ‹çœ‹React-V18å¸¦æ¥äº†ä»€ä¹ˆ"><a href="#Beforeï¼Œå…ˆçœ‹çœ‹React-V18å¸¦æ¥äº†ä»€ä¹ˆ" class="headerlink" title="Beforeï¼Œå…ˆçœ‹çœ‹React V18å¸¦æ¥äº†ä»€ä¹ˆ"></a>Beforeï¼Œå…ˆçœ‹çœ‹React V18å¸¦æ¥äº†ä»€ä¹ˆ</h3><p>å¯ä»¥å¯é€‰çš„å¼€å¯ Concurrent Modeï¼Œå¤§å¹…æé«˜äº†Reactçš„æ€§èƒ½ï¼Œæ¨å‡ºäº†æ—¶é—´åˆ‡ç‰‡å’Œä»»åŠ¡ä¼˜å…ˆçº§çš„æ¦‚å¿µï¼Œè®© React æœ‰äº†æ›´å¤šçš„å¯èƒ½æ€§ï¼Œæ›´å¤šçš„æè¿°å¯ä»¥å»çœ‹çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘ä»¬å…³æ³¨çš„ç‚¹è¿˜æ˜¯è¿™å‡ ä¸ªæ–°å¢çš„hooksï¼Œè®©æˆ‘ä»¬ç®€å•çš„äº†è§£ä¸€ä¸‹è¿™å‡ ä¸ªAPIï¼Œå…·ä½“çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥è‡ªå·±å°è¯•ä¸€ä¸‹</p>
<h3 id="useSyncExternalStore"><a href="#useSyncExternalStore" class="headerlink" title="useSyncExternalStore"></a>useSyncExternalStore</h3><p>é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªAPIæ˜¯é’ˆå¯¹Reactçš„ç¬¬ä¸‰æ–¹çŠ¶æ€ç®¡ç†åº“çš„ã€‚ç”±äºV18å¯ä»¥å¼€å¯concurrent mode,ä½¿å¾—renderè¿™ä¸ªè¿‡ç¨‹èƒ½å¤Ÿåˆ‡åˆ†æˆä»¥fiberä¸ºæœ€å°å•ä½çš„å¤šæ¬¡ä»»åŠ¡,è¿™äº›ä»»åŠ¡å¯èƒ½å°±ä¼šå­˜åœ¨å¯¹å¤–éƒ¨çŠ¶æ€çš„ä¿®æ”¹ï¼ŒåŠ å…¥åœ¨renderçš„ä»»åŠ¡åˆ†ç‰‡å‰åéƒ¨åˆ†çŠ¶æ€è¢«ä¿®æ”¹äº†ï¼Œé‚£å°±ä¼šé€ æˆå¤šæ¬¡æ¸²æŸ“ç»“æœä¸ä¸€è‡´çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯<strong>tearing é—®é¢˜</strong>ï¼Œtearing é€šä¿—åœ°è®²ï¼Œå°±æ˜¯å¤–éƒ¨çŠ¶æ€ä¸å— react å¼‚æ­¥è°ƒåº¦æ§åˆ¶ï¼Œéå¸¸å®¹æ˜“é”™ä¹±ã€‚useSyncExternalStoreå°±æ˜¯é˜²æ­¢tearingçš„å‡ºç°ï¼Œé€šè¿‡è®¢é˜…çš„æ–¹å¼ä¿æŒæœ€ç»ˆæ¸²æŸ“ç»“æœçš„ä¸€è‡´æ€§ã€‚</p>
<p>æœ€åç®€å•çœ‹çœ‹API<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">useSyncExternalStore(</div><div class="line">    subscribe, <span class="comment">// æ¥æ”¶ä¸€ä¸ªsubscribeå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‡½æ•°ç”¨äºé€šçŸ¥reactå¤–éƒ¨çŠ¶æ€å‘ç”Ÿå˜æ›´</span></div><div class="line">    getSnapshot, <span class="comment">// è¿”å›å¤–éƒ¨çŠ¶æ€çš„æœ€æ–°å¿«ç…§å€¼</span></div><div class="line">)</div></pre></td></tr></table></figure></p>
<h3 id="useTransition"><a href="#useTransition" class="headerlink" title="useTransition"></a>useTransition</h3><p>transition ç‰¹æ€§ä¹Ÿæ˜¯ä¾èµ– concurrent modeçš„ï¼Œå¯ä»¥ç”¨æ¥é™ä½æ¸²æŸ“ä¼˜å…ˆçº§ã€‚å½“æˆ‘ä»¬ç”¨startTransitionåŒ…è£¹è®¡ç®—é‡å¤§çš„å‡½æ•°çš„æ—¶å€™ï¼Œå°±ç›¸å½“äºé€šçŸ¥äº†Reactå½“å‰è®¡ç®—çš„ä¼˜å…ˆçº§å¾ˆä½ï¼Œå¯ä»¥é™ä½æ›´æ–°çš„ä¼˜å…ˆçº§ï¼Œå‡å°‘é‡å¤æ¸²æŸ“æ¬¡æ•°ï¼Œå¯ä»¥å½“æˆä¸€ä¸ªé˜²æŠ–å‡½æ•°æ¥å¤„ç†ï¼ˆä¸å®Œå…¨ç›¸åŒï¼‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Demo = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> [isPending, startTransition] = useTransition();</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">      &lt;input</div><div class="line">        type=<span class="string">"text"</span></div><div class="line">        onChange=&#123;(event) =&gt; &#123;</div><div class="line">          startTransition(<span class="function"><span class="params">()</span> =&gt;</span> &#123;<span class="built_in">console</span>.log(event.target.value);</div><div class="line">        &#125;&#125;&#125;</div><div class="line">      /&gt;</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹çœ‹å®˜æ–¹çš„è¿™ä¸ª<a href="https://codesandbox.io/s/sparkling-field-41z4r3" target="_blank" rel="external">demo</a></p>
<h3 id="useDeferredValue"><a href="#useDeferredValue" class="headerlink" title="useDeferredValue"></a>useDeferredValue</h3><p>å’ŒuseTransitionç±»ä¼¼ï¼ŒuseDeferredValueçš„ç‰¹æ€§ä¹Ÿæ˜¯ä¾èµ– concurrent mode çš„, å¯ä»¥ç›´æ¥ç¿»è¯‘ä¸ºä½¿ç”¨ä¸€ä¸ªæ¨è¿Ÿçš„å€¼ã€‚ useDeferredValue å¯ä»¥è®©æˆ‘ä»¬å»¶è¿Ÿæ¸²æŸ“ä¼˜å…ˆçº§ä¸é«˜çš„éƒ¨åˆ†ï¼Œç­‰é«˜ä¼˜å…ˆçº§çš„æ¸²æŸ“ä»»åŠ¡ç»“æŸåï¼Œå»¶è¿Ÿçš„æ¸²æŸ“æ‰å¼€å§‹ï¼Œå¹¶ä¸”å¯ä¸­æ–­ä¸ä¼šé˜»å¡ç”¨æˆ·è¾“å…¥ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Demo = <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">// React å°†ä¼šåœ¨åˆé€‚çš„æ—¶é—´ç”ŸæˆdeferredValue</span></div><div class="line">  <span class="keyword">const</span> deferredValue = useDeferredValue(value, &#123; <span class="attr">timeoutMs</span>: <span class="number">1000</span> &#125;);</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;div&gt;</div><div class="line">      &#123;</div><div class="line">        <span class="comment">//</span></div><div class="line">        deferredValue</div><div class="line">      &#125;</div><div class="line">    &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">  );</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure>
<h3 id="useInsertionEffect"><a href="#useInsertionEffect" class="headerlink" title="useInsertionEffect"></a>useInsertionEffect</h3><p>ç±»ä¼¼useLayoutEffectï¼ŒåŒºåˆ«å°±æ˜¯ä¸èƒ½è®¿é—®dom</p>
<p>useInsertionEffectçš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³cssinjsé—®é¢˜çš„ï¼Œç”¨äºæ’å…¥æ ·å¼è§„åˆ™ï¼Œè€Œä¸”ä¸€èˆ¬æ˜¯æ’å…¥å…¨å±€DOMèŠ‚ç‚¹ï¼Œæ¯”å¦‚<code>&lt;style/&gt;</code>ç­‰ã€‚è¿™ä¸ªhooksä¸ºäº†é¿å…åœ¨concurrent modeä¸‹ï¼Œå®¢æˆ·ç«¯ç”Ÿæˆæˆ–ç¼–è¾‘<code>&lt;style/&gt;</code>æ—¶å¼•èµ·æ€§èƒ½é—®é¢˜ï¼Œå¯ä»¥åœ¨è¿™ä¸ªhooksä¸­æ“ä½œæ’å…¥ä¸€äº›cssèŠ‚ç‚¹<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">useCSS</span>(<span class="params">rule</span>) </span>&#123;</div><div class="line">  useInsertionEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">document</span>.head.appendChild(rule);</div><div class="line">  &#125;);</div><div class="line">  <span class="keyword">return</span> rule;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> Demo = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">let</span> className = useCSS(rule);</div><div class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;className&#125;</span> /&gt;</span>;</span></div><div class="line"><span class="xml">&#125;</span></div></pre></td></tr></table></figure></p>
<h3 id="useID"><a href="#useID" class="headerlink" title="useID"></a>useID</h3><p>ä¸€èˆ¬ç”¨äºæœåŠ¡ç«¯æ¸²æŸ“ï¼Œç”Ÿæˆä¸€ä¸ªIDï¼Œä½†æ˜¯ä¸è¦æŠŠè¿™ä¸ªIDä½œä¸ºæ•°ç»„å¾ªç¯æ¸²æŸ“çš„keyï¼Œæ¸²æŸ“çš„å”¯ä¸€keyä¸€èˆ¬æ˜¯ä»ä½ çš„æ•°æ®ä¸­ç”Ÿæˆçš„, å°±ä¸å†è¯¦ç»†ä»‹ç»äº†</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>React Hookså¾ˆå¥½ç”¨ï¼Œä½†æ˜¯æƒ³ç”¨å¥½ï¼Œè¿˜æ˜¯éœ€è¦å¤šä¸€ç‚¹æ€è€ƒçš„ã€‚æ¡†æ¶æä¾›çš„èƒ½åŠ›ï¼Œæƒ³è½¬æ¢ä¸ºå®é™…çš„ç”Ÿäº§åŠ›å°±éœ€è¦æˆ‘ä»¬ä¸åœçš„å»å­¦ä¹ å¦‚ä½•ä½¿ç”¨è¿™äº›èƒ½åŠ›ï¼Œä¸æ–­æ€»ç»“ï¼Œæœ‰é—®é¢˜å¯ä»¥ç•™è¨€äº¤æµ</p>
<p><strong>å‚è€ƒèµ„æ–™</strong></p>
<p><a href="https://react.html.cn/docs/refs-and-the-dom.html" target="_blank" rel="external">Refs å’Œ DOMå®˜æ–¹æ–‡æ¡£</a><br><a href="https://zh-hans.reactjs.org/docs/hooks-custom.html" target="_blank" rel="external">è‡ªå®šä¹‰ Hook</a><br><a href="https://www.zhihu.com/question/502917860" target="_blank" rel="external">å¦‚ä½•ç†è§£ React 18 ä¸­çš„ useSyncExternalStore ?</a><br><a href="https://blog.shabby.in/how-to-use-useTransition/useDerferredValue/" target="_blank" rel="external">useTransition/useDerferredValueä½¿ç”¨æŒ‡å—</a></p>
<p><img src="http://static.zhyjor.com/wexin.png" alt=""></p>

      
    </div>

	<div>
      
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  
  <!-- JSåº“ sweetalert å¯ä¿®æ”¹è·¯å¾„ -->
  <script type="text/javascript" src="http://jslibs.wuxubj.cn/sweetalert_mini/jquery-1.7.1.min.js"></script>
  <script src="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.min.js"></script>
  <link rel="stylesheet" type="text/css" href="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.mini.css">
  <p><span>æœ¬æ–‡æ ‡é¢˜:</span><a href="/2022/12/01/éƒ½React V18äº†ï¼Œè¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨Hookså—/">éƒ½React V18äº†,è¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨React Hookså—,ä¸‡å­—é•¿æ–‡è§£æHooksçš„å¸¸è§é—®é¢˜</a></p>
  <p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="è®¿é—® zhyjor çš„ä¸ªäººåšå®¢">zhyjor</a></p>
  <p><span>å‘å¸ƒæ—¶é—´:</span>2022å¹´12æœˆ01æ—¥ - 14:12</p>
  <p><span>æœ€åæ›´æ–°:</span>2023å¹´10æœˆ11æ—¥ - 02:10</p>
  <p><span>åŸå§‹é“¾æ¥:</span><a href="/2022/12/01/éƒ½React V18äº†ï¼Œè¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨Hookså—/" title="éƒ½React V18äº†,è¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨React Hookså—,ä¸‡å­—é•¿æ–‡è§£æHooksçš„å¸¸è§é—®é¢˜">https://zhyjor.github.io/2022/12/01/éƒ½React V18äº†ï¼Œè¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨Hookså—/</a>
    <span class="copy-path"  title="ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æ¥"><i class="fa fa-clipboard" data-clipboard-text="https://zhyjor.github.io/2022/12/01/éƒ½React V18äº†ï¼Œè¿˜ä¸ä¼šæ­£ç¡®ä½¿ç”¨Hookså—/"  aria-label="å¤åˆ¶æˆåŠŸï¼"></i></span>
  </p>
  <p><span>è®¸å¯åè®®:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
	clipboard.on('success', $(function(){
	  $(".fa-clipboard").click(function(){
		swal({   
		  title: "",   
		  text: 'å¤åˆ¶æˆåŠŸ',   
		  html: false,
		  timer: 500,   
		  showConfirmButton: false
	    });
	  });
    }));  
</script>

      
	</div>
	
    <div>
      
        

      
    </div>
  
        <div class="post-tags">
          
            <a href="/tags/js/" rel="tag"># js</a>
          
            <a href="/tags/React/" rel="tag"># React</a>
          
        </div>
      


    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>ğŸ¶ æ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œ ğŸ¶</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>èµèµ</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wechat-reward-img.jpg" alt="zhyjor WeChat Pay"/>
          <p>å¾®ä¿¡æ‰“èµ</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/images/alipay-reward-img.jpg" alt="zhyjor Alipay"/>
          <p>æ”¯ä»˜å®æ‰“èµ</p>
        </div>
      
    </div>
  </div>


      
    </div>


    <footer class="post-footer">
         
      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2022/11/25/æˆ‘æ˜¯å¦‚ä½•ä»eggjså‡çº§åˆ°midwayjsçš„/" rel="next" title="æˆ‘æ˜¯å¦‚ä½•ä»eggjså‡çº§åˆ°midwayjsçš„">
                <i class="fa fa-chevron-left"></i> æˆ‘æ˜¯å¦‚ä½•ä»eggjså‡çº§åˆ°midwayjsçš„
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2022/12/08/ä»æºç çš„è§’åº¦å›ç­”ReactHooksé¢è¯•é¢˜/" rel="prev" title="ä»æºç çš„è§’åº¦å›ç­”ReactHooksé¢è¯•é¢˜">
                ä»æºç çš„è§’åº¦å›ç­”ReactHooksé¢è¯•é¢˜ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          

  <p>çƒ­è¯„æ–‡ç« </p>
  <div class="ds-top-threads" data-range="monthly" data-num-items="4"></div>


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMTE5Ny83NzQ2"></div>
	
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="zhyjor" />
          <p class="site-author-name" itemprop="name">zhyjor</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">336</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">62</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">182</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/zhyjor" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/zhyjor" target="_blank" title="weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/zhyjor" target="_blank" title="zhihu">
                  
                    <i class="fa fa-fw fa-battery-3"></i>
                  
                  zhihu
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              å‹æƒ…é“¾æ¥
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.woaitqs.cc/" title="Qisen Tang" target="_blank">Qisen Tang</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://szhshp.org" title="szhshpçš„åšå®¢" target="_blank">szhshpçš„åšå®¢</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://python.zhangwei.website" title="JuniorCoder" target="_blank">JuniorCoder</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://hippo-jessy.com" title="Hippo" target="_blank">Hippo</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.zhihu.com/people/lippi-ouyang" title="å‹é“¾å‡ºç§Ÿ" target="_blank">å‹é“¾å‡ºç§Ÿ</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å¼‚æ­¥è°ƒç”¨çš„é—­åŒ…é—®é¢˜"><span class="nav-number">1.</span> <span class="nav-text">å¼‚æ­¥è°ƒç”¨çš„é—­åŒ…é—®é¢˜</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ›´è¿‘ä¸€æ­¥"><span class="nav-number">1.1.</span> <span class="nav-text">æ›´è¿‘ä¸€æ­¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å°ç»“"><span class="nav-number">1.2.</span> <span class="nav-text">å°ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç”¨useCallbackè‚¯å®šèƒ½æå‡æ€§èƒ½å—"><span class="nav-number">2.</span> <span class="nav-text">ç”¨useCallbackè‚¯å®šèƒ½æå‡æ€§èƒ½å—</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ€è€ƒé¢˜"><span class="nav-number">2.1.</span> <span class="nav-text">æ€è€ƒé¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å°ç»“-1"><span class="nav-number">2.2.</span> <span class="nav-text">å°ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hooksç»„ä»¶æ€ä¹ˆä¼˜é›…çš„ä½¿ç”¨refs"><span class="nav-number">3.</span> <span class="nav-text">hooksç»„ä»¶æ€ä¹ˆä¼˜é›…çš„ä½¿ç”¨refs</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#useRef"><span class="nav-number">3.1.</span> <span class="nav-text">useRef</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è·å–ç‰¹å®šdom"><span class="nav-number">3.1.1.</span> <span class="nav-text">è·å–ç‰¹å®šdom</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#useRef-forwardRef-useImperativeHandleç»„åˆç”¨æ³•"><span class="nav-number">3.2.</span> <span class="nav-text">useRef,forwardRef,useImperativeHandleç»„åˆç”¨æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å°ç»“-2"><span class="nav-number">3.3.</span> <span class="nav-text">å°ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¦‚ä½•å°è£…è‡ªå®šä¹‰hooks"><span class="nav-number">4.</span> <span class="nav-text">å¦‚ä½•å°è£…è‡ªå®šä¹‰hooks</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æå–è‡ªå®šä¹‰-hooks"><span class="nav-number">4.1.</span> <span class="nav-text">æå–è‡ªå®šä¹‰ hooks</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#useStateå±æ€§åˆå¹¶"><span class="nav-number">4.2.</span> <span class="nav-text">useStateå±æ€§åˆå¹¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#domç›¸å…³çš„hooks"><span class="nav-number">4.3.</span> <span class="nav-text">domç›¸å…³çš„hooks</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#éœ€æ±‚åˆ†æ"><span class="nav-number">4.3.1.</span> <span class="nav-text">éœ€æ±‚åˆ†æ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä»£ç å®ç°"><span class="nav-number">4.3.2.</span> <span class="nav-text">ä»£ç å®ç°</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#é˜²æŠ–å‡½æ•°"><span class="nav-number">4.4.</span> <span class="nav-text">é˜²æŠ–å‡½æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä»£ç å®ç°-1"><span class="nav-number">4.4.1.</span> <span class="nav-text">ä»£ç å®ç°</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å°ç»“-3"><span class="nav-number">4.5.</span> <span class="nav-text">å°ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#React-V18æ–°å¢äº†å“ªäº›hooks-API"><span class="nav-number">5.</span> <span class="nav-text">React V18æ–°å¢äº†å“ªäº›hooks API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Beforeï¼Œå…ˆçœ‹çœ‹React-V18å¸¦æ¥äº†ä»€ä¹ˆ"><span class="nav-number">5.1.</span> <span class="nav-text">Beforeï¼Œå…ˆçœ‹çœ‹React V18å¸¦æ¥äº†ä»€ä¹ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#useSyncExternalStore"><span class="nav-number">5.2.</span> <span class="nav-text">useSyncExternalStore</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#useTransition"><span class="nav-number">5.3.</span> <span class="nav-text">useTransition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#useDeferredValue"><span class="nav-number">5.4.</span> <span class="nav-text">useDeferredValue</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#useInsertionEffect"><span class="nav-number">5.5.</span> <span class="nav-text">useInsertionEffect</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#useID"><span class="nav-number">5.6.</span> <span class="nav-text">useID</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ€»ç»“"><span class="nav-number">6.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhyjor</span>
</div>



<!--
<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io" rel="external nofollow">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">
    NexT.Mist
  </a>
</div>
-->

<div class="powered-by">
<i class="fa fa-user-md"></i>
<span id="busuanzi_container_site_pv">
    æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
</span>
</div>
<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">åšå®¢å…¨ç«™å…±338.7kå­—</span>
</div>





        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"ezlippi"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="//cdn.jsdelivr.net/ua-parser.js/0.7.10/ua-parser.min.js"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  














  
  

  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
<div id="hexo-helper-live2d">
  <canvas id="live2dcanvas" width="150" height="300"></canvas>
</div>
<style>
  #live2dcanvas{
    position: fixed;
    width: 150px;
    height: 300px;
    opacity:0.7;
    right: 0px;
    z-index: 999;
    pointer-events: none;
    bottom: -20px;
  }
</style>
<script type="text/javascript" src="/live2d/device.min.js"></script>
<script type="text/javascript">
const loadScript = function loadScript(c,b){var a=document.createElement("script");a.type="text/javascript";"undefined"!=typeof b&&(a.readyState?a.onreadystatechange=function(){if("loaded"==a.readyState||"complete"==a.readyState)a.onreadystatechange=null,b()}:a.onload=function(){b()});a.src=c;document.body.appendChild(a)};
(function(){
  if((typeof(device) != 'undefined') && (device.mobile())){
    document.getElementById("live2dcanvas").style.width = '75px';
    document.getElementById("live2dcanvas").style.height = '150px';
  }else
    if (typeof(device) === 'undefined') console.error('Cannot find current-device script.');
  loadScript("/live2d/script.js", function(){loadlive2d("live2dcanvas", "/live2d/assets/tororo.model.json", 0.5);});
})();
</script>

<style>
#live2dcanvas{
  position: fixed;
	bottom: 0px;
	left: 0px;
	z-index: 999;
	width: 150px;
	height: 300px;
  pointer-events: none;
  opacity: 1;
}
</style>
</body>
</html>
